/* empty css                  */import{g as e,a as t}from"./data-BgyXqgYe.js";/* empty css                 */import{a}from"./exceljs-BFEwRFjg.js";import{c as l,d as n,b as o,h as r,j as i,k as d,l as s,m as u}from"./element-plus-DdJDmifE.js";import{X as c,r as m,h as v,z as p,A as f,P as g,H as h,M as y,a5 as b,O as w,y as k,L as A}from"./vue-Bfue4d1g.js";import{_ as x}from"./index-CvfZAQEr.js";import"./pinia-DgiqAucS.js";var E,j={exports:{}};E=j,function(){function e(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function t(e,t,a){var l=new XMLHttpRequest;l.open("GET",e),l.responseType="blob",l.onload=function(){i(l.response,t,a)},l.onerror=function(){},l.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(a){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof l&&l.global===l?l:void 0,r=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(e,l,r){var i=o.URL||o.webkitURL,d=document.createElement("a");l=l||e.name||"download",d.download=l,d.rel="noopener","string"==typeof e?(d.href=e,d.origin===location.origin?n(d):a(d.href)?t(e,l,r):n(d,d.target="_blank")):(d.href=i.createObjectURL(e),setTimeout((function(){i.revokeObjectURL(d.href)}),4e4),setTimeout((function(){n(d)}),0))}:"msSaveOrOpenBlob"in navigator?function(l,o,r){if(o=o||l.name||"download","string"!=typeof l)navigator.msSaveOrOpenBlob(e(l,r),o);else if(a(l))t(l,o,r);else{var i=document.createElement("a");i.href=l,i.target="_blank",setTimeout((function(){n(i)}))}}:function(e,a,l,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return t(e,a,l);var i="application/octet-stream"===e.type,d=/constructor/i.test(o.HTMLElement)||o.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&d||r)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=s?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},u.readAsDataURL(e)}else{var c=o.URL||o.webkitURL,m=c.createObjectURL(e);n?n.location=m:location.href=m,n=null,setTimeout((function(){c.revokeObjectURL(m)}),4e4)}});o.saveAs=i.saveAs=i,E.exports=i}();var C=j.exports;const z={class:"result"},R={class:"head"},S={class:"method"},B={class:"nextButton"},V={class:"info"},L={class:"item"},U={class:"item"},G={class:"item"},T={class:"avgChart"},_={class:"chart"};const O=x({setup(){const l=c(e),n=m(!1),o=c(t),r=m(void 0),i=m(void 0),d=m(!1),s=m(void 0);function u(){l.forEach((e=>{let t=0,a=0;e.members.forEach((e=>{d.value&&0===e.grade||(t+=e.grade,a++)})),e.averageGrade=a>0?t/a:0}))}function p(){let e=0,t=0,a=0,l=0;return o.forEach((n=>{d.value&&0===n.grade||("男"===n.sex?(e+=n.grade,a++):"女"===n.sex&&(t+=n.grade,l++))})),{maleAverage:a>0?e/a:0,femaleAverage:l>0?t/l:0}}function f(){const e=new a.Workbook,t=e.addWorksheet("成绩单");t.columns=[{header:"名次",key:"sort",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"组",key:"name",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"组员",key:"members",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"分数",key:"grade",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"均分",key:"averageGrade",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"男生平均分数",key:"maleAverage",width:20,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"女生平均分数",key:"femaleAverage",width:20,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"学生",key:"allStudents",width:20,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"成绩",key:"grade",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}}];const{maleAverage:n,femaleAverage:r}=p();t.addRow({maleAverage:n,femaleAverage:r});let i=o.toSorted(((e,t)=>t.grade-e.grade)),u=l.toSorted(((e,t)=>t.averageGrade-e.averageGrade)),c=2;i.forEach(((e,a)=>{t.getCell("H"+c).value=e.name;let l=t.getCell("I"+c);l.value=e.grade,s.value&&e.grade<s.value&&(l.style={font:{color:{argb:"FF0000"}},alignment:{vertical:"middle",horizontal:"center"}}),d.value&&0===e.grade&&(l.value="未算入",l.style={alignment:{vertical:"middle",horizontal:"center"}}),c++}));let m=2;u.forEach(((e,a)=>{let l=m;if(e.members.forEach(((e,a)=>{t.getCell("C"+m).value=e.name;let l=t.getCell("D"+m);l.value=e.grade,s.value&&e.grade<s.value&&(l.style={font:{color:{argb:"FF0000"}},alignment:{vertical:"middle",horizontal:"center"}}),d.value&&0===e.grade&&(l.value="未算入",l.style={alignment:{vertical:"middle",horizontal:"center"}}),m++})),e.members.length>1){let e=m-1;t.mergeCells(`A${l}:A${e}`),t.mergeCells(`B${l}:B${e}`),t.mergeCells(`E${l}:E${e}`)}t.getCell("A"+l).value=a+1,t.getCell("B"+l).value=e.name,t.getCell("E"+l).value=e.averageGrade})),e.xlsx.writeBuffer().then((e=>{let t=new Blob([e],{type:"application/octet-stream"});C.saveAs(t,"ExcelJS.xlsx")}))}return v(d,((e,t)=>{u()}),{immediate:!0}),{computedSexGrade:p,group:l,findStudentByNumber:function(e=0){return(o.find((t=>t.num===e))||{name:"（键入正确学号以检索学生）"}).name},showResult:n,test:function(){f()},data:o,isFullPerson:d,inputNumber:r,grade:i,handleInput:function(){i.value&&i.value>=0?(o.find((e=>e.num===r.value)).grade=i.value,i.value=void 0,r.value=void 0,u()):alert("成绩或学号输入有误")},handleInputToExpert:function(){i.value=void 0,r.value=void 0,n.value=!0,setTimeout((()=>{f(),n.value=!1}),3e3)},passGrade:s}}},[["render",function(e,t,a,l,c,m){const v=s,x=n,E=o,j=r,C=i,O=u,F=d;return k(),p(w,null,[t[8]||(t[8]=f("h1",{class:"title"},null,-1)),t[9]||(t[9]=f("h1",{class:"tlt"},"登分器",-1)),g(x,{modelValue:l.showResult,"onUpdate:modelValue":t[0]||(t[0]=e=>l.showResult=e)},{default:h((()=>[f("div",z,[g(v,{title:"Please wait","sub-title":"We're preparing your result.But you can close this dialog."})])])),_:1},8,["modelValue"]),f("main",null,[f("div",R,[f("div",S,[f("div",B,[g(E,{onClick:l.handleInput},{default:h((()=>t[5]||(t[5]=[A("Next")]))),_:1},8,["onClick"]),g(E,{onClick:l.handleInputToExpert},{default:h((()=>t[6]||(t[6]=[A("导出")]))),_:1},8,["onClick"]),g(E,{onClick:l.test},{default:h((()=>t[7]||(t[7]=[A("test")]))),_:1},8,["onClick"]),g(j,{modelValue:l.passGrade,"onUpdate:modelValue":t[1]||(t[1]=e=>l.passGrade=e),placeholder:"及格分数",size:"small"},null,8,["modelValue"]),g(C,{modelValue:l.isFullPerson,"onUpdate:modelValue":t[2]||(t[2]=e=>l.isFullPerson=e),label:"是否去除未考式人员"},null,8,["modelValue"])]),f("div",V,[g(j,{min:1,max:63,class:"item",modelValue:l.inputNumber,"onUpdate:modelValue":t[3]||(t[3]=e=>l.inputNumber=e),size:"large",placeholder:"学号"},null,8,["modelValue"]),f("h2",L,"当前学生："+y(l.findStudentByNumber(l.inputNumber)),1),g(j,{min:0,class:"item",modelValue:l.grade,"onUpdate:modelValue":t[4]||(t[4]=e=>l.grade=e),size:"large",placeholder:"分数",onKeyup:b(l.handleInput,["enter"])},null,8,["modelValue","onKeyup"]),f("h3",U," 男生平均分数："+y(l.computedSexGrade().maleAverage),1),f("h3",G," 女生平均分数："+y(l.computedSexGrade().femaleAverage),1)])]),f("div",T,[g(F,{data:l.group,border:""},{default:h((()=>[g(O,{prop:"id",label:"组别"}),g(O,{prop:"averageGrade",label:"平均分"})])),_:1},8,["data"])])]),f("div",_,[g(F,{data:l.data,height:"500",border:"",style:{width:"100%"}},{default:h((()=>[g(O,{prop:"num",label:"学号"}),g(O,{prop:"name",label:"姓名"}),g(O,{prop:"grade",label:"成绩"})])),_:1},8,["data"])])])],64)}],["__scopeId","data-v-ab9090df"]]);export{O as default};
