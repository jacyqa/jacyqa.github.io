/* empty css                  *//* empty css                 */import{u as e,w as a}from"./xlsx-BJEeCk4N.js";import{Z as n,a as m,q as s,t as r,U as u,O as d,T as l,a9 as t,F as o,p as g,S as i}from"./vue-DnAlJlYy.js";import{_ as x}from"./index-DyBYygqE.js";import{b as p,E as c,c as b,d as h,e as v,f,g as G}from"./element-plus-D3K_IVQ1.js";import"./pinia-BDOM517y.js";const _=[{id:1,name:"Group1",members:[{num:1,name:"马佐涵",grade:0,sex:"女"},{num:2,name:"张潇予",grade:0,sex:"女"},{num:42,name:"姚思明",grade:0,sex:"男"},{num:34,name:"何易",grade:0,sex:"男"},{num:57,name:"王欣竹",grade:0,sex:"女"},{num:6,name:"王梦佳",grade:0,sex:"女"},{num:63,name:"王星程",grade:0,sex:"男"}]},{id:2,name:"Group2",members:[{num:8,name:"刘博凌",grade:0,sex:"男"},{num:9,name:"丁宜冰",grade:0,sex:"男"},{num:17,name:"贾济玮",grade:0,sex:"男"},{num:26,name:"李婧璇",grade:0,sex:"女"},{num:49,name:"李俊霖",grade:0,sex:"男"},{num:13,name:"孟令瑶",grade:0,sex:"女"},{num:39,name:"张洪睿",grade:0,sex:"男"}]},{id:3,name:"Group3",members:[{num:15,name:"赵轩毅",grade:0,sex:"男"},{num:52,name:"杨祺",grade:0,sex:"男"},{num:27,name:"王军",grade:0,sex:"男"},{num:19,name:"李芷漩",grade:0,sex:"女"},{num:32,name:"燕禛",grade:0,sex:"男"},{num:7,name:"王子阳",grade:0,sex:"男"},{num:33,name:"李卿",grade:0,sex:"男"}]},{id:4,name:"Group4",members:[{num:5,name:"翟雅荣",grade:0,sex:"女"},{num:21,name:"张智博",grade:0,sex:"男"},{num:22,name:"刘舜华",grade:0,sex:"女"},{num:25,name:"陈姝贝",grade:0,sex:"女"},{num:30,name:"郝欣雨",grade:0,sex:"女"},{num:40,name:"薛星戈",grade:0,sex:"女"},{num:47,name:"韩林荣轩",grade:0,sex:"男"}]},{id:5,name:"Group5",members:[{num:4,name:"丁玺腾",grade:0,sex:"男"},{num:10,name:"张星辰",grade:0,sex:"男"},{num:14,name:"韩瑜章",grade:0,sex:"男"},{num:18,name:"赵泽寰",grade:0,sex:"男"},{num:24,name:"曹华亭",grade:0,sex:"女"},{num:48,name:"李昱萱",grade:0,sex:"女"}]},{id:6,name:"Group6",members:[{num:11,name:"薛奕洋",grade:0,sex:"女"},{num:20,name:"谢易娜",grade:0,sex:"女"},{num:31,name:"周兴",grade:0,sex:"女"},{num:38,name:"吉星霖",grade:0,sex:"女"},{num:44,name:"王紫涵",grade:0,sex:"女"},{num:51,name:"武韵涵",grade:0,sex:"女"},{num:62,name:"杨紫煜",grade:0,sex:"女"}]},{id:7,name:"Group7",members:[{num:12,name:"张灵桥",grade:0,sex:"女"},{num:16,name:"王峥",grade:0,sex:"男"},{num:35,name:"王子涵",grade:0,sex:"女"},{num:43,name:"张馨月",grade:0,sex:"女"},{num:46,name:"屈睿东",grade:0,sex:"男"},{num:56,name:"段旻岑",grade:0,sex:"女"},{num:60,name:"张楷浩",grade:0,sex:"男"}]},{id:8,name:"Group8",members:[{num:28,name:"常雨馨",grade:0,sex:"女"},{num:41,name:"索嘉澳",grade:0,sex:"男"},{num:50,name:"昝瑛畦",grade:0,sex:"男"},{num:54,name:"林轩",grade:0,sex:"男"},{num:55,name:"尹婧琦",grade:0,sex:"女"},{num:58,name:"段京辰",grade:0,sex:"男"},{num:59,name:"王荣美",grade:0,sex:"女"}]},{id:9,name:"Group9",members:[{num:3,name:"杨子睿",grade:0,sex:"男"},{num:23,name:"马翔",grade:0,sex:"男"},{num:36,name:"宋忻豫",grade:0,sex:"女"},{num:37,name:"田谨赫",grade:0,sex:"男"},{num:45,name:"魏兆骏",grade:0,sex:"男"},{num:53,name:"么雨忱",grade:0,sex:"男"},{num:61,name:"荣鑫宇",grade:0,sex:"女"}]}];const k=function(e){let a=[];return e.forEach((e=>{a=a.concat(e.members)})),a}(_),C={class:"result"},V={class:"head"},j={class:"methed"},N={class:"nextButton"},w={class:"info"},y={class:"item"},E={class:"avgChart"},I={class:"chart"};const T=x({setup(){const s=n(_),r=m(!1),u=n(k),d=m(null),l=m(void 0),t=m(!1);function o(n=s,m="result.xlsx"){const r=e.book_new(),u=e.json_to_sheet(n);e.book_append_sheet(r,u,"Sheet1"),a(r,m)}return m(!1),s.reduce(((e,a)=>(a.members.forEach((n=>{e.push({"Group Name":a.name,"Member Name":n.name,"Member Grade":n.grade,"Average Grade":a.averageGrade})})),e)),[]),{group:s,findStudentByNumber:function(e=0){return(u.find((a=>a.num===e))||{name:"（键入正确学号以检索学生）"}).name},showResult:r,test:function(){o(s,"6.xlsx")},data:u,isFullPerson:t,inputNumber:d,grade:l,handleInput:function(){l.value&&l.value>=0?(u.find((e=>e.num===d.value)).grade=l.value,l.value=void 0,d.value=void 0,s.forEach((e=>{const a=e.members.reduce(((e,a)=>e+a.grade),0),n=e.members.length>0?a/e.members.length:0;e.averageGrade=n}))):alert("成绩或学号输入有误")},handleInputToExpert:function(){l.value=void 0,d.value=void 0,r.value=!0,setTimeout((()=>{o(),r.value=!1}),3e3)},CheckToCalculateGroupAverages:function(){}}}},[["render",function(e,a,n,m,x,_){const k=f,T=p,U=c,B=b,F=h,P=G,S=v;return g(),s(o,null,[a[7]||(a[7]=r("h1",{class:"title"},null,-1)),a[8]||(a[8]=r("h1",{class:"tlt"},"登分器",-1)),u(T,{modelValue:m.showResult,"onUpdate:modelValue":a[0]||(a[0]=e=>m.showResult=e)},{default:d((()=>[r("div",C,[u(k,{title:"Please wait","sub-title":"We're preparing your result.But you can close this dialog."})])])),_:1},8,["modelValue"]),r("main",null,[r("div",V,[r("div",j,[r("div",N,[u(U,{onClick:m.handleInput},{default:d((()=>a[4]||(a[4]=[i("Next")]))),_:1},8,["onClick"]),u(U,{onClick:m.handleInputToExpert},{default:d((()=>a[5]||(a[5]=[i("导出")]))),_:1},8,["onClick"]),u(U,{onClick:m.test},{default:d((()=>a[6]||(a[6]=[i("test")]))),_:1},8,["onClick"]),u(B,{modelValue:m.isFullPerson,"onUpdate:modelValue":a[1]||(a[1]=e=>m.isFullPerson=e),onClick:m.CheckToCalculateGroupAverages,label:"是否去除未考式人员"},null,8,["modelValue","onClick"])]),r("div",w,[u(F,{min:1,max:63,class:"item",modelValue:m.inputNumber,"onUpdate:modelValue":a[2]||(a[2]=e=>m.inputNumber=e),size:"large",placeholder:"学号"},null,8,["modelValue"]),r("h2",y,"当前学生："+l(m.findStudentByNumber(m.inputNumber)),1),u(F,{min:0,class:"item",modelValue:m.grade,"onUpdate:modelValue":a[3]||(a[3]=e=>m.grade=e),size:"large",placeholder:"分数",onKeyup:t(m.handleInput,["enter"])},null,8,["modelValue","onKeyup"])])]),r("div",E,[u(S,{data:m.group,border:""},{default:d((()=>[u(P,{prop:"id",label:"组别"}),u(P,{prop:"averageGrade",label:"平均分"})])),_:1},8,["data"])])]),r("div",I,[u(S,{data:m.data,height:"500",border:"",style:{width:"100%"}},{default:d((()=>[u(P,{prop:"num",label:"学号"}),u(P,{prop:"name",label:"姓名"}),u(P,{prop:"grade",label:"成绩"})])),_:1},8,["data"])])])],64)}],["__scopeId","data-v-219f1243"]]);export{T as default};
