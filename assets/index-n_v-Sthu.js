/* empty css                  *//* empty css                 */import{e}from"./exceljs-CMFzP55Z.js";import{c as a,b as n,E as t,d as r,e as l,f as m,h as o,j as d}from"./element-plus-Ddzdm0FS.js";import{Z as s,a as u,b as i,t as g,v as c,U as v,O as p,T as f,a9 as x,F as h,q as b,S as y}from"./vue-RFioqU9x.js";import{_ as w}from"./index-fTYUtoNy.js";import"./pinia-D64ldcNt.js";const k=[{id:1,name:"Group1",members:[{num:1,name:"马佐涵",grade:0,sex:"女"},{num:2,name:"张潇予",grade:0,sex:"女"},{num:42,name:"姚思明",grade:0,sex:"男"},{num:34,name:"何易",grade:0,sex:"男"},{num:57,name:"王欣竹",grade:0,sex:"女"},{num:6,name:"王梦佳",grade:0,sex:"女"},{num:63,name:"王星程",grade:0,sex:"男"}]},{id:2,name:"Group2",members:[{num:8,name:"刘博凌",grade:0,sex:"男"},{num:9,name:"丁宜冰",grade:0,sex:"男"},{num:17,name:"贾济玮",grade:0,sex:"男"},{num:26,name:"李婧璇",grade:0,sex:"女"},{num:49,name:"李俊霖",grade:0,sex:"男"},{num:13,name:"孟令瑶",grade:0,sex:"女"},{num:39,name:"张洪睿",grade:0,sex:"男"}]},{id:3,name:"Group3",members:[{num:15,name:"赵轩毅",grade:0,sex:"男"},{num:52,name:"杨祺",grade:0,sex:"男"},{num:27,name:"王军",grade:0,sex:"男"},{num:19,name:"李芷漩",grade:0,sex:"女"},{num:32,name:"燕禛",grade:0,sex:"男"},{num:7,name:"王子阳",grade:0,sex:"男"},{num:33,name:"李卿",grade:0,sex:"男"}]},{id:4,name:"Group4",members:[{num:5,name:"翟雅荣",grade:0,sex:"女"},{num:21,name:"张智博",grade:0,sex:"男"},{num:22,name:"刘舜华",grade:0,sex:"女"},{num:25,name:"陈姝贝",grade:0,sex:"女"},{num:30,name:"郝欣雨",grade:0,sex:"女"},{num:40,name:"薛星戈",grade:0,sex:"女"},{num:47,name:"韩林荣轩",grade:0,sex:"男"}]},{id:5,name:"Group5",members:[{num:4,name:"丁玺腾",grade:0,sex:"男"},{num:10,name:"张星辰",grade:0,sex:"男"},{num:14,name:"韩瑜章",grade:0,sex:"男"},{num:18,name:"赵泽寰",grade:0,sex:"男"},{num:24,name:"曹华亭",grade:0,sex:"女"},{num:48,name:"李昱萱",grade:0,sex:"女"}]},{id:6,name:"Group6",members:[{num:11,name:"薛奕洋",grade:0,sex:"女"},{num:20,name:"谢易娜",grade:0,sex:"女"},{num:31,name:"周兴",grade:0,sex:"女"},{num:38,name:"吉星霖",grade:0,sex:"女"},{num:44,name:"王紫涵",grade:0,sex:"女"},{num:51,name:"武韵涵",grade:0,sex:"女"},{num:62,name:"杨紫煜",grade:0,sex:"女"}]},{id:7,name:"Group7",members:[{num:12,name:"张灵桥",grade:0,sex:"女"},{num:16,name:"王峥",grade:0,sex:"男"},{num:35,name:"王子涵",grade:0,sex:"女"},{num:43,name:"张馨月",grade:0,sex:"女"},{num:46,name:"屈睿东",grade:0,sex:"男"},{num:56,name:"段旻岑",grade:0,sex:"女"},{num:60,name:"张楷浩",grade:0,sex:"男"}]},{id:8,name:"Group8",members:[{num:28,name:"常雨馨",grade:0,sex:"女"},{num:41,name:"索嘉澳",grade:0,sex:"男"},{num:50,name:"昝瑛畦",grade:0,sex:"男"},{num:54,name:"林轩",grade:0,sex:"男"},{num:55,name:"尹婧琦",grade:0,sex:"女"},{num:58,name:"段京辰",grade:0,sex:"男"},{num:59,name:"王荣美",grade:0,sex:"女"}]},{id:9,name:"Group9",members:[{num:3,name:"杨子睿",grade:0,sex:"男"},{num:23,name:"马翔",grade:0,sex:"男"},{num:36,name:"宋忻豫",grade:0,sex:"女"},{num:37,name:"田谨赫",grade:0,sex:"男"},{num:45,name:"魏兆骏",grade:0,sex:"男"},{num:53,name:"么雨忱",grade:0,sex:"男"},{num:61,name:"荣鑫宇",grade:0,sex:"女"}]}];const E=function(e){let a=[];return e.forEach((e=>{a=a.concat(e.members)})),a}(k);var A,G={exports:{}};A=G,function(){function e(e,a){return void 0===a?a={autoBom:!1}:"object"!=typeof a&&(a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,a,n){var t=new XMLHttpRequest;t.open("GET",e),t.responseType="blob",t.onload=function(){o(t.response,a,n)},t.onerror=function(){},t.send()}function t(e){var a=new XMLHttpRequest;a.open("HEAD",e,!1);try{a.send()}catch(n){}return 200<=a.status&&299>=a.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(a)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,m=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!m?function(e,a,m){var o=l.URL||l.webkitURL,d=document.createElement("a");a=a||e.name||"download",d.download=a,d.rel="noopener","string"==typeof e?(d.href=e,d.origin===location.origin?r(d):t(d.href)?n(e,a,m):r(d,d.target="_blank")):(d.href=o.createObjectURL(e),setTimeout((function(){o.revokeObjectURL(d.href)}),4e4),setTimeout((function(){r(d)}),0))}:"msSaveOrOpenBlob"in navigator?function(a,l,m){if(l=l||a.name||"download","string"!=typeof a)navigator.msSaveOrOpenBlob(e(a,m),l);else if(t(a))n(a,l,m);else{var o=document.createElement("a");o.href=a,o.target="_blank",setTimeout((function(){r(o)}))}}:function(e,a,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return n(e,a,t);var o="application/octet-stream"===e.type,d=/constructor/i.test(l.HTMLElement)||l.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||o&&d||m)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=s?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},u.readAsDataURL(e)}else{var i=l.URL||l.webkitURL,g=i.createObjectURL(e);r?r.location=g:location.href=g,r=null,setTimeout((function(){i.revokeObjectURL(g)}),4e4)}});l.saveAs=o.saveAs=o,A.exports=o}();var j=G.exports;const C={class:"result"},R={class:"head"},S={class:"method"},z={class:"nextButton"},B={class:"info"},U={class:"item"},V={class:"item"},L={class:"item"},T={class:"avgChart"},_={class:"chart"};const F=w({setup(){const a=s(k),n=u(!1),t=s(E),r=u(void 0),l=u(void 0),m=u(!1),o=u(void 0);function d(){a.forEach((e=>{let a=0,n=0;e.members.forEach((e=>{m.value&&0===e.grade||(a+=e.grade,n++)})),e.averageGrade=n>0?a/n:0}))}function g(){let e=0,a=0,n=0,r=0;return t.forEach((t=>{m.value&&0===t.grade||("男"===t.sex?(e+=t.grade,n++):"女"===t.sex&&(a+=t.grade,r++))})),{maleAverage:n>0?e/n:0,femaleAverage:r>0?a/r:0}}function c(){const n=new e.Workbook,r=n.addWorksheet("成绩单");r.columns=[{header:"名次",key:"sort",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"组",key:"name",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"组员",key:"members",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"分数",key:"grade",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"均分",key:"averageGrade",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"男生平均分数",key:"maleAverage",width:20,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"女生平均分数",key:"femaleAverage",width:20,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"学生",key:"allStudents",width:20,style:{alignment:{vertical:"middle",horizontal:"center"}}},{header:"成绩",key:"grade",width:10,style:{alignment:{vertical:"middle",horizontal:"center"}}}];const{maleAverage:l,femaleAverage:d}=g();r.addRow({maleAverage:l,femaleAverage:d});let s=t.toSorted(((e,a)=>a.grade-e.grade)),u=a.toSorted(((e,a)=>a.averageGrade-e.averageGrade)),i=2;s.forEach(((e,a)=>{r.getCell("H"+i).value=e.name;let n=r.getCell("I"+i);n.value=e.grade,o.value&&e.grade<o.value&&(n.style={font:{color:{argb:"FF0000"}},alignment:{vertical:"middle",horizontal:"center"}}),m.value&&0===e.grade&&(n.value="未算入",n.style={alignment:{vertical:"middle",horizontal:"center"}}),i++}));let c=2;u.forEach(((e,a)=>{let n=c;if(e.members.forEach(((e,a)=>{r.getCell("C"+c).value=e.name;let n=r.getCell("D"+c);n.value=e.grade,o.value&&e.grade<o.value&&(n.style={font:{color:{argb:"FF0000"}},alignment:{vertical:"middle",horizontal:"center"}}),m.value&&0===e.grade&&(n.value="未算入",n.style={alignment:{vertical:"middle",horizontal:"center"}}),c++})),e.members.length>1){let e=c-1;r.mergeCells(`A${n}:A${e}`),r.mergeCells(`B${n}:B${e}`),r.mergeCells(`E${n}:E${e}`)}r.getCell("A"+n).value=a+1,r.getCell("B"+n).value=e.name,r.getCell("E"+n).value=e.averageGrade})),n.xlsx.writeBuffer().then((e=>{let a=new Blob([e],{type:"application/octet-stream"});j.saveAs(a,"ExcelJS.xlsx")}))}return i(m,((e,a)=>{d()}),{immediate:!0}),{computedSexGrade:g,group:a,findStudentByNumber:function(e=0){return(t.find((a=>a.num===e))||{name:"（键入正确学号以检索学生）"}).name},showResult:n,test:function(){c()},data:t,isFullPerson:m,inputNumber:r,grade:l,handleInput:function(){l.value&&l.value>=0?(t.find((e=>e.num===r.value)).grade=l.value,l.value=void 0,r.value=void 0,d()):alert("成绩或学号输入有误")},handleInputToExpert:function(){l.value=void 0,r.value=void 0,n.value=!0,setTimeout((()=>{c(),n.value=!1}),3e3)},passGrade:o}}},[["render",function(e,a,s,u,i,w){const k=o,E=n,A=t,G=r,j=l,F=d,O=m;return b(),g(h,null,[a[8]||(a[8]=c("h1",{class:"title"},null,-1)),a[9]||(a[9]=c("h1",{class:"tlt"},"登分器",-1)),v(E,{modelValue:u.showResult,"onUpdate:modelValue":a[0]||(a[0]=e=>u.showResult=e)},{default:p((()=>[c("div",C,[v(k,{title:"Please wait","sub-title":"We're preparing your result.But you can close this dialog."})])])),_:1},8,["modelValue"]),c("main",null,[c("div",R,[c("div",S,[c("div",z,[v(A,{onClick:u.handleInput},{default:p((()=>a[5]||(a[5]=[y("Next")]))),_:1},8,["onClick"]),v(A,{onClick:u.handleInputToExpert},{default:p((()=>a[6]||(a[6]=[y("导出")]))),_:1},8,["onClick"]),v(A,{onClick:u.test},{default:p((()=>a[7]||(a[7]=[y("test")]))),_:1},8,["onClick"]),v(G,{modelValue:u.passGrade,"onUpdate:modelValue":a[1]||(a[1]=e=>u.passGrade=e),placeholder:"及格分数",size:"small"},null,8,["modelValue"]),v(j,{modelValue:u.isFullPerson,"onUpdate:modelValue":a[2]||(a[2]=e=>u.isFullPerson=e),label:"是否去除未考式人员"},null,8,["modelValue"])]),c("div",B,[v(G,{min:1,max:63,class:"item",modelValue:u.inputNumber,"onUpdate:modelValue":a[3]||(a[3]=e=>u.inputNumber=e),size:"large",placeholder:"学号"},null,8,["modelValue"]),c("h2",U,"当前学生："+f(u.findStudentByNumber(u.inputNumber)),1),v(G,{min:0,class:"item",modelValue:u.grade,"onUpdate:modelValue":a[4]||(a[4]=e=>u.grade=e),size:"large",placeholder:"分数",onKeyup:x(u.handleInput,["enter"])},null,8,["modelValue","onKeyup"]),c("h3",V," 男生平均分数："+f(u.computedSexGrade().maleAverage),1),c("h3",L," 女生平均分数："+f(u.computedSexGrade().femaleAverage),1)])]),c("div",T,[v(O,{data:u.group,border:""},{default:p((()=>[v(F,{prop:"id",label:"组别"}),v(F,{prop:"averageGrade",label:"平均分"})])),_:1},8,["data"])])]),c("div",_,[v(O,{data:u.data,height:"500",border:"",style:{width:"100%"}},{default:p((()=>[v(F,{prop:"num",label:"学号"}),v(F,{prop:"name",label:"姓名"}),v(F,{prop:"grade",label:"成绩"})])),_:1},8,["data"])])])],64)}],["__scopeId","data-v-ab9090df"]]);export{F as default};
